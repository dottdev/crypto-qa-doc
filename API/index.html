
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ROADMAP/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>ç³»çµ± API - åŠ å¯†è²¨å¹£é‡åŒ–åˆ†æç³»çµ±</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-design" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="åŠ å¯†è²¨å¹£é‡åŒ–åˆ†æç³»çµ±" class="md-header__button md-logo" aria-label="åŠ å¯†è²¨å¹£é‡åŒ–åˆ†æç³»çµ±" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            åŠ å¯†è²¨å¹£é‡åŒ–åˆ†æç³»çµ±
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ç³»çµ± API
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  é¦–é 

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../README.md" class="md-tabs__link">
          
  
  
  å°ˆæ¡ˆä»‹ç´¹

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="åŠ å¯†è²¨å¹£é‡åŒ–åˆ†æç³»çµ±" class="md-nav__button md-logo" aria-label="åŠ å¯†è²¨å¹£é‡åŒ–åˆ†æç³»çµ±" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    åŠ å¯†è²¨å¹£é‡åŒ–åˆ†æç³»çµ±
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    é¦–é 
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    å°ˆæ¡ˆä»‹ç´¹
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    å°ˆæ¡ˆä»‹ç´¹
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../README.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    å°ˆæ¡ˆç°¡ä»‹
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ROADMAP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ç™¼å±•è·¯ç·š
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    ç³»çµ± API
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    ç³»çµ± API
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ai-development-constraints-ai" class="md-nav__link">
    <span class="md-ellipsis">
      
        âš ï¸ AI Development Constraints (AI é–‹ç™¼é™åˆ¶)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envelope-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        çµ±ä¸€å›æ‡‰æ ¼å¼ (Envelope Pattern)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="çµ±ä¸€å›æ‡‰æ ¼å¼ (Envelope Pattern)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Schema
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        0. Authentication (èº«ä»½é©—è­‰)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-system-config" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. System Config (ç³»çµ±è¨­å®š)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. System Config (ç³»çµ±è¨­å®š)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Schemas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-market-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Market Data (å¸‚å ´æ•¸æ“š)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Market Data (å¸‚å ´æ•¸æ“š)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#market-data-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Market Data Schemas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Analysis (é‡åŒ–åˆ†æèˆ‡å›æ¸¬)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Analysis (é‡åŒ–åˆ†æèˆ‡å›æ¸¬)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analysis Schemas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-trading" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Trading (å¯¦ç›¤/æ¨¡æ“¬äº¤æ˜“)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Trading (å¯¦ç›¤/æ¨¡æ“¬äº¤æ˜“)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trading-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trading Schemas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ai-development-constraints-ai" class="md-nav__link">
    <span class="md-ellipsis">
      
        âš ï¸ AI Development Constraints (AI é–‹ç™¼é™åˆ¶)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envelope-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        çµ±ä¸€å›æ‡‰æ ¼å¼ (Envelope Pattern)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="çµ±ä¸€å›æ‡‰æ ¼å¼ (Envelope Pattern)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Schema
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        0. Authentication (èº«ä»½é©—è­‰)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-system-config" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. System Config (ç³»çµ±è¨­å®š)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. System Config (ç³»çµ±è¨­å®š)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Schemas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-market-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Market Data (å¸‚å ´æ•¸æ“š)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Market Data (å¸‚å ´æ•¸æ“š)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#market-data-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Market Data Schemas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Analysis (é‡åŒ–åˆ†æèˆ‡å›æ¸¬)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Analysis (é‡åŒ–åˆ†æèˆ‡å›æ¸¬)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analysis Schemas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-trading" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Trading (å¯¦ç›¤/æ¨¡æ“¬äº¤æ˜“)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Trading (å¯¦ç›¤/æ¨¡æ“¬äº¤æ˜“)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trading-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trading Schemas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api-design">ğŸ”Œ API design</h1>
<p>æ‰€æœ‰ API å‡åŸºæ–¼ Django Ninjaï¼Œé è¨­å‰ç¶´ç‚º <code>/api</code></p>
<h2 id="ai-development-constraints-ai">âš ï¸ AI Development Constraints (AI é–‹ç™¼é™åˆ¶)</h2>
<blockquote>
<p><strong>[IMPORTANT]</strong></p>
</blockquote>
<ul>
<li>All REST API endpoints <strong>MUST</strong> use the <code>ApiResponse[T] wrapper defined in</code>backend.core.schemas`.<ol>
<li>âœ… <strong>Correct</strong>: <code>def get_item(...) -&gt; ApiResponse[ItemSchema]:</code></li>
<li>âŒ <strong>Incorrect</strong>: <code>def get_item(...) -&gt; ItemSchema:</code></li>
</ol>
</li>
<li><strong>Error Handling</strong>:<ol>
<li>Use <code>django.shortcuts.get_object_or_404</code>.</li>
<li>For business logic errors, return `ApiResponse(code=-1, message="...") instead of raising 500 exceptions.</li>
</ol>
</li>
</ul>
<h2 id="envelope-pattern">çµ±ä¸€å›æ‡‰æ ¼å¼ (Envelope Pattern)</h2>
<p>ç‚ºäº†å‰å¾Œç«¯ä¸²æ¥çš„ä¸€è‡´æ€§ï¼Œæ‰€æœ‰ API (é™¤ç‰¹å®šäºŒé€²ä½æµæˆ–éæ¨™æº–ä»‹é¢) çš†æ¡ç”¨ä»¥ä¸‹ JSON çµæ§‹ï¼š</p>
<pre><code class="language-json">{
    &quot;code&quot;: 0,              // 0: æˆåŠŸ, -1: éŒ¯èª¤, &gt;0: å…¶ä»–éŒ¯èª¤ä»£ç¢¼
    &quot;message&quot;: &quot;success&quot;,   // äººé¡å¯è®€è¨Šæ¯
    &quot;data&quot;: { ... }         // å¯¦éš›è³‡æ–™ payload
}
</code></pre>
<p>ä»¥ä¸‹å®šç¾©æ ¸å¿ƒçš„ Request/Response Schema</p>
<h3 id="core-schema">Core Schema</h3>
<pre><code class="language-python">class ApiResponse(Schema, Generic[T]):
    code: int = 0               # 0: æˆåŠŸ, -1: éŒ¯èª¤, &gt;0: ç‰¹å®šéŒ¯èª¤ä»£ç¢¼
    message: str = &quot;success&quot;
    data: Optional[T] = None
</code></pre>
<h2 id="0-authentication">0. Authentication (èº«ä»½é©—è­‰)</h2>
<p>ç³»çµ±æ¡ç”¨ JWT (JSON Web Token) é€²è¡Œé©—è­‰ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Endpoint</th>
<th style="text-align: left;">åŠŸèƒ½èªªæ˜</th>
<th style="text-align: left;">Body</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>POST</strong></td>
<td style="text-align: left;"><code>/auth/token</code></td>
<td style="text-align: left;">ç™»å…¥ä¸¦ç²å– Access/Refresh Token</td>
<td style="text-align: left;"><code>{username, password}</code></td>
</tr>
<tr>
<td style="text-align: left;"><strong>POST</strong></td>
<td style="text-align: left;"><code>/auth/token/refresh</code></td>
<td style="text-align: left;">åˆ·æ–° Access Token</td>
<td style="text-align: left;"><code>{refresh}</code></td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/auth/me</code></td>
<td style="text-align: left;">ç²å–ç•¶å‰ç™»å…¥è€…è³‡è¨Šèˆ‡æ¬Šé™ç¾¤çµ„</td>
<td style="text-align: left;">-</td>
</tr>
</tbody>
</table>
<h2 id="1-system-config">1. System Config (ç³»çµ±è¨­å®š)</h2>
<p>å®šç¾©æ–¼ <code>backend/apps/system/api.py</code>ã€‚
è² è²¬æœ¬ç³»çµ±ç›¸é—œè¨­ç½®</p>
<ul>
<li><strong>åˆå§‹åŒ–</strong>: ç³»çµ±å•Ÿå‹•æ™‚æœƒé€é <code>seed_settings</code> æŒ‡ä»¤è‡ªå‹•å¯«å…¥é è¨­å€¼ã€‚</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Endpoint</th>
<th style="text-align: left;">åŠŸèƒ½èªªæ˜</th>
<th style="text-align: left;">Body / Query</th>
<th style="text-align: left;">ç‹€æ…‹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/sys/health</code></td>
<td style="text-align: left;">ç³»çµ±å¥åº·æª¢æŸ¥ã€‚</td>
<td style="text-align: left;">docker Healthcheck ç”¨</td>
<td style="text-align: left;">âœ… å®Œæˆ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/sys/info</code></td>
<td style="text-align: left;">ç³»çµ±è³‡æºç‹€æ…‹ (CPU, Memory, Disk)</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/sys/settings</code></td>
<td style="text-align: left;">åˆ—å‡ºç³»çµ±æ‰€æœ‰è¨­å®šã€‚</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">âœ… å®Œæˆ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/sys/settings/{key}</code></td>
<td style="text-align: left;">ç²å–å–®ä¸€è¨­å®šè©³æƒ…ã€‚</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">âœ… å®Œæˆ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>PUT</strong></td>
<td style="text-align: left;"><code>/sys/settings/{key}</code></td>
<td style="text-align: left;">æ›´æ–°ç³»çµ±è¨­å®šã€‚</td>
<td style="text-align: left;"><code>SystemSettingUpdateSchema</code></td>
<td style="text-align: left;">âœ… å®Œæˆ</td>
</tr>
</tbody>
</table>
<h3 id="system-schemas">System Schemas</h3>
<pre><code class="language-python"># Update Request (Input)
class SystemSettingUpdateSchema(Schema):
    value: Any                  # å…è¨±ä¸åŒå‹æ…‹ (int, str, bool, dict)ï¼Œå¾Œç«¯éœ€åšé©—è­‰
    description: Optional[str] = None

# Response Object (Output)
class SystemSettingOut(Schema):
    key: str
    value: Any                          # ä¸åŒ key çš„çµæ§‹å¯èƒ½ä¸åŒ
    description: str
    updated_at: datetime
    updated_by: Optional[str] = None    # å›å‚³ Username æˆ– User ID

class SystemSettingResponse(ApiSchema[SystemSettingOut]):
    pass

class SystemSettingListResponse(ApiSchema[list[SystemSettingOut]]):
    pass
</code></pre>
<h2 id="2-market-data">2. Market Data (å¸‚å ´æ•¸æ“š)</h2>
<p>å®šç¾©æ–¼ <code>backend/apps/market_data/api.py</code>ã€‚
è² è²¬æ•¸æ“šæ¸…æ´—ã€å„²å­˜èˆ‡è®€å– (Parquet)ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Endpoint</th>
<th style="text-align: left;">åŠŸèƒ½èªªæ˜</th>
<th style="text-align: left;">Body / Query</th>
<th style="text-align: left;">ç‹€æ…‹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/mkt/sources</code></td>
<td style="text-align: left;">ç²å–æ”¯æ´çš„äº¤æ˜“æ‰€åˆ—è¡¨</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">âœ… å®Œæˆ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/mkt/sources/discover</code></td>
<td style="text-align: left;">åˆ—å‡ºCCXTå¯ç”¨çš„äº¤æ˜“æ‰€</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">âœ… å®Œæˆ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>POST</strong></td>
<td style="text-align: left;"><code>/mkt/sources/{exchange_id}/enable</code></td>
<td style="text-align: left;">å•Ÿç”¨äº¤æ˜“æ‰€è³‡æ–™</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">ğŸš§ é€²è¡Œä¸­</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/mkt/test-connection</code></td>
<td style="text-align: left;">æ¸¬è©¦é€£ç·š</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">âœ… å®Œæˆ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/mkt/symbols</code></td>
<td style="text-align: left;">æœå°‹/åˆ—å‡ºäº¤æ˜“æ‰€çš„äº¤æ˜“å°</td>
<td style="text-align: left;"><code>?exchange=binance&amp;q=BTC</code></td>
<td style="text-align: left;">ğŸš§ é€²è¡Œä¸­</td>
</tr>
<tr>
<td style="text-align: left;"><strong>POST</strong></td>
<td style="text-align: left;"><code>/mkt/track</code></td>
<td style="text-align: left;">å°‡äº¤æ˜“å°åŠ å…¥æœ¬åœ°è¿½è¹¤æ¸…å–® (å­˜å…¥ DB)</td>
<td style="text-align: left;"><code>{ "symbol": "BTC/USDT", "source": "binance" }</code></td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/mkt/tracked</code></td>
<td style="text-align: left;">ç²å–ç›®å‰å·²è¿½è¹¤çš„äº¤æ˜“å°ç‹€æ…‹ (æ•¸æ“šå®Œæ•´æ€§)</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/mkt/candles</code></td>
<td style="text-align: left;"><strong>ã€æ ¸å¿ƒã€‘</strong> è®€å– K ç·šæ•¸æ“š (ä¾›å‰ç«¯ç¹ªåœ–)</td>
<td style="text-align: left;"><code>?symbol=BTC/USDT&amp;tf=1h&amp;start=...&amp;end=...</code></td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/mkt/sync-test</code></td>
<td style="text-align: left;">è§¸ç™¼ä¸‹è¼‰ä¸¦å­˜æª”</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">ğŸš§ é€²è¡Œä¸­</td>
</tr>
<tr>
<td style="text-align: left;"><strong>POST</strong></td>
<td style="text-align: left;"><code>/mkt/sync</code></td>
<td style="text-align: left;">è§¸ç™¼æ‰‹å‹•æ•¸æ“šè£œå…¨ä»»å‹™</td>
<td style="text-align: left;"><code>SyncRequest</code></td>
<td style="text-align: left;">ğŸš§ é€²è¡Œä¸­</td>
</tr>
<tr>
<td style="text-align: left;"><strong>POST</strong></td>
<td style="text-align: left;"><code>/mkt//sync/history</code></td>
<td style="text-align: left;">ä¸‹è¼‰æ­·å²æ•¸æ“š</td>
<td style="text-align: left;"><code>HistorySyncRequest</code></td>
<td style="text-align: left;">ğŸš§ é€²è¡Œä¸­</td>
</tr>
</tbody>
</table>
<h3 id="market-data-schemas">Market Data Schemas</h3>
<pre><code class="language-python"># -- Input Schemas
class SyncRequest(Schema):
    source: str = &quot;binance&quot;
    symbol: str = &quot;BTC/USDT&quot;
    market_type: str = &quot;spot&quot;
    timeframe: str = &quot;1d&quot;
    days: int = 30

class HistorySyncRequest(Schema):
    symbol: str = &quot;BTCUSDT&quot;
    market_type: str = &quot;spot&quot;   # spot, um (usdt-m future)
    timeframe: str = &quot;1h&quot;
    start_year: int = 2020
    end_year: int = 2023
    months: list[int] = []      # è‹¥ç‚ºç©ºå‰‡ä¸‹è¼‰æ•´å¹´
    keep_raw: bool = True       # æ˜¯å¦ä¿ç•™åŸå§‹æª”
    asset_class: str = &quot;crypto&quot; # é ç•™ TradFi æ¬„ä½

# --- Output Schemas (Data Payload)

class ExchangeOut(Schema):
    id: str         # &quot;binance&quot;
    name: str       # &quot;Binance å¹£å®‰&quot;
    supported_market_types: list[str]   # [&quot;spot&quot;, &quot;usdt_futures&quot;]
    is_active: bool

class ExchangeListResponse(ApiResponse[list[ExchangeOut]]):
    pass

class DiscoveryOut(Schema):
    id: str
    name: str
    has_ohlcv: bool
    in_system: bool

class DiscoveryResponse(ApiResponse[list[DiscoveryOut]]):
    pass

class SymbolOut(Schema):
    id: int             # å°æ‡‰ Symbol çš„è‡ªå‹• id
    name: str           # å°æ‡‰ Symbol.name
    exchange_id: str    # Django Ninja å¯è‡ªå‹•å°æ‡‰åˆ° s.exchange_id

    # åŸæœ¬çš„ market_type
    market_type: str

class SymbolResponse(ApiResponse[SymbolOut]):
    pass

class TestConnectionOut(Schema):
    exchange: str
    url_used: str
    symbols_count: int
    symbols_sample: list[Any]

class SyncTestOut(Schema):
    symbol: str
    rows: int
    path: str

class SyncJobOut(Schema):
    task_id: str | None = None
    status: str
    details: Any = None
</code></pre>
<h2 id="3-analysis">3. Analysis (é‡åŒ–åˆ†æèˆ‡å›æ¸¬)</h2>
<p>å®šç¾©æ–¼ <code>backend/apps/analysis/api.py</code>ã€‚
è² è²¬æŠ€è¡“æŒ‡æ¨™è¨ˆç®—èˆ‡ç­–ç•¥å›æ¸¬ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Endpoint</th>
<th style="text-align: left;">åŠŸèƒ½èªªæ˜</th>
<th style="text-align: left;">Body / Query</th>
<th style="text-align: left;">ç‹€æ…‹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/ana/indicators</code></td>
<td style="text-align: left;">ç²å–ç³»çµ±æ”¯æ´çš„æŠ€è¡“æŒ‡æ¨™æ¸…å–® (å¦‚ MA, RSI)</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>POST</strong></td>
<td style="text-align: left;"><code>/ana/preview</code></td>
<td style="text-align: left;">å¿«é€Ÿè¨ˆç®—æŒ‡æ¨™ä¸¦å›å‚³ (ä¸å­˜ DBï¼Œå‰ç«¯é è¦½ç”¨)</td>
<td style="text-align: left;"><code>{ "symbol": "BTC/USDT", "indicators": [...] }</code></td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>POST</strong></td>
<td style="text-align: left;"><code>/ana/backtest/run</code></td>
<td style="text-align: left;"><strong>ã€æ ¸å¿ƒã€‘</strong> æäº¤å›æ¸¬ä»»å‹™</td>
<td style="text-align: left;"><code>BacktestConfigSchema</code></td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/ana/backtest/{id}</code></td>
<td style="text-align: left;">æŸ¥è©¢å›æ¸¬ç‹€æ…‹èˆ‡ç°¡æ˜“çµæœ</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/ana/backtest/{id}/result</code></td>
<td style="text-align: left;">ç²å–è©³ç´°å›æ¸¬å ±å‘Š (æ¬Šç›Šæ›²ç·šã€äº¤æ˜“æ˜ç´°)</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
</tbody>
</table>
<h3 id="analysis-schemas">Analysis Schemas</h3>
<pre><code class="language-python"># å›æ¸¬è¨­å®š
class BacktestConfigSchema(Schema):
    strategy_name: str       # ä¾‹å¦‚ &quot;RsiStrategy&quot;
    symbol: str              # &quot;ETH/USDT&quot;
    timeframe: str           # &quot;15m&quot;
    start_time: datetime
    end_time: datetime
    initial_capital: float   # åˆå§‹è³‡é‡‘
    params: Dict[str, Any]   # ç­–ç•¥åƒæ•¸ e.g. {&quot;rsi_period&quot;: 14, &quot;overbought&quot;: 70}

# å›æ¸¬çµæœæ‘˜è¦
class BacktestResultSchema(Schema):
    id: str
    status: str              # &quot;pending&quot;, &quot;running&quot;, &quot;completed&quot;, &quot;failed&quot;
    total_return: float      # ç¸½å ±é…¬ç‡ %
    max_drawdown: float      # æœ€å¤§å›æ’¤ %
    win_rate: float          # å‹ç‡
    total_trades: int        # ç¸½äº¤æ˜“æ¬¡æ•¸
</code></pre>
<h2 id="4-trading">4. Trading (å¯¦ç›¤/æ¨¡æ“¬äº¤æ˜“)</h2>
<p>å®šç¾©æ–¼ <code>backend/apps/trading/api.py</code>ã€‚è² è²¬å°æ¥äº¤æ˜“æ‰€ API é€²è¡Œä¸‹å–®èˆ‡å¸³æˆ¶ç®¡ç†ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Endpoint</th>
<th style="text-align: left;">åŠŸèƒ½èªªæ˜</th>
<th style="text-align: left;">Body / Query</th>
<th style="text-align: left;">ç‹€æ…‹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/trade/accounts</code></td>
<td style="text-align: left;">ç²å–äº¤æ˜“æ‰€å¸³æˆ¶é¤˜é¡èˆ‡æ¬Šç›Š</td>
<td style="text-align: left;"><code>?exchange=binance</code></td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/trade/positions</code></td>
<td style="text-align: left;">ç²å–ç•¶å‰æŒå€‰ (Positions)</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>POST</strong></td>
<td style="text-align: left;"><code>/trade/order</code></td>
<td style="text-align: left;">ç™¼é€ä¸‹å–®è«‹æ±‚ (å¸‚åƒ¹/é™åƒ¹)</td>
<td style="text-align: left;"><code>OrderCreateSchema</code></td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>DELETE</strong></td>
<td style="text-align: left;"><code>/trade/order/{id}</code></td>
<td style="text-align: left;">å–æ¶ˆè¨‚å–®</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GET</strong></td>
<td style="text-align: left;"><code>/trade/history</code></td>
<td style="text-align: left;">ç²å–æ­·å²æˆäº¤ç´€éŒ„</td>
<td style="text-align: left;"><code>?limit=50</code></td>
<td style="text-align: left;">â³ æœªé–‹å§‹</td>
</tr>
</tbody>
</table>
<h3 id="trading-schemas">Trading Schemas</h3>
<pre><code class="language-python"># ä¸‹å–®è«‹æ±‚
class OrderCreateSchema(Schema):
    symbol: str
    side: str                # &quot;buy&quot; or &quot;sell&quot;
    type: str                # &quot;limit&quot; or &quot;market&quot;
    quantity: float
    price: Optional[float]   # å¸‚åƒ¹å–®å¯ç‚º None
    leverage: int = 1        # æ§“æ¡¿å€æ•¸
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.instant", "navigation.tabs"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>