# ç™¼å±•è¨ˆåŠƒ

æ­¤å°ˆæ¡ˆæœ€çµ‚ç›®æ¨™ç‚ºè‡ªå‹•äº¤æ˜“ç³»çµ±ï¼Œä¾æ“šä½¿ç”¨è€…æ‰€è¨‚å®šçš„ç­–ç•¥ï¼Œä¸¦å¸Œæœ›å°æ–¼ç›®å‰æ‰€æœ‰çš„é‡‘èå•†å“ (åŒ…æ‹¬å‚³çµ±äº¤æ˜“ç³»çµ±)ï¼Œå¯ä»¥é€éæ­¤ç³»çµ±åšå€‹äººè¨­å®šï¼Œä¸¦é€²ä¸€æ­¥ç›´æ¥é€²è¡Œäº¤æ˜“ã€‚

## é …ç›®åŠŸèƒ½

TBD

## ç¡¬é«”ç’°å¢ƒ

- Server: Intel i9 (è² è²¬é‹ç®—èˆ‡ ç”¢å“ç·šçš„ Docker é‹è¡Œï¼Œç›®å‰é‚„æ˜¯ç™¼å±•éšæ®µï¼Œæ•…å°šæœªä½¿)
- Client: iMac M3 (è² è²¬é–‹ç™¼èˆ‡ç€è¦½å™¨æ“ä½œï¼Œé–‹ç™¼ç’°å¢ƒåŸ·è¡Œï¼Œä½†ç›®å‰ä¹Ÿæ˜¯ç™¼å±•éšæ®µçš„åŸ·è¡Œç’°å¢ƒ)
- è³‡æ–™å„²å­˜: æœ¬åœ°ç£ç¢Ÿæ©Ÿ Parquet æª”æ¡ˆã€‚

## æŠ€è¡“å †ç–Š (Tech Stack)

- **Backend**: Python 3.12, Django Ninja, uv (å¥—ä»¶ç®¡ç†), Pandas, Polars.
- **Frontend**: SvelteKit, TypeScript, Shadcn-Svelte, TailwindCSS.
- **Charts**: TradingView Lightweight Charts.
- **Infra**: Docker Compose, PostgreSQL (å­˜ metadata), Redis.

## å°ˆæ¡ˆç›®éŒ„çµæ§‹ (Monorepo)

- `data/`: å­˜æ”¾ parquet/raw æ•¸æ“š (Docker volume æ›è¼‰è‡³ /app/data)ã€‚
- `backend/`: Django å°ˆæ¡ˆæ ¹ç›®éŒ„ (manage.py åœ¨æ­¤)ã€‚
  - `core/`: å…¨åŸŸè¨­ç½®
  - `apps/`: ä¾é ˜åŸŸåˆ† (market_data, analysis, trading)ã€‚
  - `services/`: ç´” Python å•†æ¥­é‚è¼¯å±¤ã€‚
- `frontend/`: SvelteKit å°ˆæ¡ˆã€‚

## Roadmap

ä¾æ­¤ç™¼å±•é †åºï¼Œé€æ­¥å®Œæˆç³»çµ±ï¼Œå¾åŠ å¯†è²¨å¹£é‡åŒ–åˆ†æé–‹å§‹ï¼Œå®Œæˆå¾Œï¼Œå†åŠ å…¥å‚³çµ±é‡‘èå•†å“çš„äº¤æ˜“ã€‚

### åŠ å¯†è²¨å¹£é‡åŒ–äº¤æ˜“ç³»çµ±

#### Phase 1: æ•¸æ“šåŸºç¤å»ºè¨­ (Data Infrastructure)

ç›®æ¨™ï¼šå»ºç«‹å¯é çš„æœ¬åœ°æ•¸æ“šæ± ï¼Œä¸¦èƒ½åœ¨å‰ç«¯è¦–è¦ºåŒ–ã€‚é‡é»åœ¨æ–¼ market_data æ¨¡çµ„å¯¦ä½œã€‚

- [âœ…] **æ–‡æª”ä¸­å¿ƒå»ºè¨­ (Documentation)**:
  - [âœ…] éƒ¨ç½² MkDocs è‡³ GitHub Pages [Crypto-QA Documentation](https://your-username.github.io/crypto-qa-doc/)ã€‚
  - [âœ…] **API æ–‡ä»¶æŠ½é›¢**: å°‡ API è¦æ ¼å¾ README ç§»è‡³ç¨ç«‹ MkDocs å°ˆæ¡ˆï¼Œä»¥ä¾¿æ–¼ç¶­è­·èˆ‡å…¬é–‹æŸ¥é–±ã€‚
  - [âœ…] æ•´åˆ MANUAL.md èˆ‡ ROADMAP.md è‡³æ–‡æª”ç«™é»ã€‚
- [ğŸš§] **ç³»çµ±åŸºç¤è¨­å®š (System Config)**:
  - [âœ…] å»ºç«‹ `SystemSetting` Model (åŒ…å« audit æ¬„ä½: updated_by)ã€‚
  - [âœ…] å¯¦ä½œ CRUD API çµ±ä¸€å›æ‡‰æ ¼å¼ (`ApiResponse<T>`)ã€‚
  - [âœ…] å‰ç«¯åŸºç¤å»ºè¨­ (`config.ts`, `types.ts`, `api/system.ts`): å®Œæˆ System Setting çš„ API å°è£ (List/Get/Update)ã€‚
  - [ğŸš§] å‰ç«¯è¨­å®šé é¢ (`/settings`) UI æ•´åˆèˆ‡æ¸¬è©¦ã€‚
  - [ ] å®Œæˆ `ParquetConfigSchema` é©—è­‰é‚è¼¯ã€‚
- [ğŸš§] äº¤æ˜“æ‰€é©é…å™¨ (Exchange Adaptor): å®Œå–„ `backend/services/exchanges/`ï¼Œå¯¦ä½œ `Binance/OKX/Coinbase` çš„ä¸‹è¼‰æ­·å²æ•¸æ“šã€‚
  - [âœ…] å®šç¾© `BaseExchangeClient` ä»‹é¢ã€‚
  - [ğŸš§] å¯¦ä½œ `BinanceClient` åŸºç¤é€£ç·šèˆ‡è¨­å®š (ä½¿ç”¨ CCXT)
  - [ ] å„ªåŒ–ï¼šå¯¦ä½œ Binance Vision (Bulk Data) ä¸‹è¼‰å™¨ï¼Œç”¨æ–¼å¿«é€Ÿç²å–æ­·å²å†·æ•¸æ“šã€‚
  - [ ] å¯¦ä½œ `get_markets` èˆ‡ `fetch_ohlcv` çš„æ•´åˆæ¸¬è©¦
  - [ ] å¯¦ä½œ OKX/Coinbase çš„é©é…å™¨
- [ ] ETL æµç¨‹ (Data Pipeline): å»ºç«‹å®šæœŸä»»å‹™ (å¯ä½¿ç”¨ Celery æˆ–ç°¡å–®çš„ Cron)ï¼Œå°‡åŸå§‹æ•¸æ“šæ¸…æ´—ï¼Œä¸¦è½‰å­˜ç‚º Parquetã€‚
  - é—œéµ: ç¢ºä¿ Parquet çš„ Partitioning ç­–ç•¥æ­£ç¢ºã€‚æŒ‰ Symbol/Year/Month æˆ– Symbol/Timeframeï¼Œé€™å° Polars çš„è®€å–é€Ÿåº¦å¾ˆé‡è¦ã€‚
- [ ] K ç·šè¦–è¦ºåŒ–: å‰ç«¯æ•´åˆ Lightweight Chartsï¼Œé€é Django Ninja è®€å– Parquet ä¸¦å›å‚³çµ¦ SvelteKit æ¸²æŸ“ã€‚

#### Phase 1.5: å‰ç«¯ç¤å»ºè¨­ (Frontend Infrastructure)

- [ğŸš§] **App Shell ä½ˆå±€å¯¦ä½œ**:
  - [ ] å¯¦ä½œå¯æŠ˜ç–Šå¼ Sidebar (Collapsible Sidebar) ä»¥æœ€å¤§åŒ–åœ–è¡¨ç©ºé–“ã€‚
  - [ ] å¯¦ä½œ Status Bar ç›£æ§å¾Œç«¯é€£ç·šå¥åº·åº¦ (`/api/sys/health`)ã€‚
  - [ ] æ•´åˆ Shadcn `Dark Mode`ï¼Œé©æ‡‰é•·æ™‚é–“çœ‹ç›¤éœ€æ±‚ã€‚

#### Phase 2: ç­–ç•¥å›æ¸¬å¼•æ“ (Backtesting Engine)

ç›®æ¨™ï¼šé©—è­‰äº¤æ˜“è¼¯çš„ç²åˆ©èƒ½åŠ›ã€‚æ­¤ç‚º analysis æ¨¡çµ„çš„æ ¸å¿ƒã€‚

- æŒ‡æ¨™åº« (Indicator Lib): åœ¨ backend/services/indicator_calc.py ä¸­å°è£ pandas-ta æˆ–è‡ªè¡Œç”¨ polars å¯«é«˜æ€§èƒ½æŒ‡æ¨™è¨ˆç®—ã€‚
- å‘é‡åŒ–å›æ¸¬ (Vectorized Backtest): åˆ©ç”¨ Polars çš„æ¥µé€Ÿç‰¹æ€§ï¼Œé‡å°æ­·å²æ•¸æ“šé€²è¡Œå…¨é‡å›æ¸¬ (ä¸è€ƒé‡æ»‘é»èˆ‡è©³ç´°æ“åˆ)ï¼Œå¿«é€Ÿç¯©é¸ç­–ç•¥ã€‚
- å›æ¸¬å ±å‘Š: åœ¨å‰ç«¯é¡¯ç¤ºæ¬Šç›Šæ›²ç·š (Equity Curve)ã€æœ€å¤§å›æ’¤ (MOD)ã€å¤æ™®æ¯”ç‡ (Sharpe Ratio)ã€‚

#### Phase 3: æ¨¡æ“¬äº¤æ˜“èˆ‡äº‹ä»¶é©…å‹• (Paper Trading & Event Loop)

ç›®æ¨™ï¼šå¾ã€Œéœæ…‹åˆ†æã€è½‰å‘ã€Œå‹•æ…‹äº¤æ˜“ã€ï¼Œä½†ä¸æ¶‰åŠå¯¦éš›äº¤æ˜“ã€‚å¾æ­¤é–‹å§‹é€²å…¥ trading æ¨¡çµ„ã€‚

- æ¨¡æ“¬äº¤æ˜“æ‰€ (Paper Exchange): å¯«ä¸€å€‹å‡çš„äº¤æ˜“æ‰€ Classï¼Œæ¨¡æ“¬è¨‚å–®æ“åˆã€æ‰‹çºŒè²»èˆ‡æ»‘é»ã€‚
- äº‹ä»¶é©…å‹•å¼•æ“ (Event-Driven Engine): ç‚ºäº†å°‡ä¾†çš„è‡ªå‹•äº¤æ˜“ï¼Œéœ€è¦ä¸€å€‹å¯æ¥æ”¶ WebSocket å³æ™‚å ±åƒ¹ä¸¦è§¸ç™¼ç­–ç•¥çš„è¿´åœˆã€‚
  é€™èˆ‡ Phase 2 çš„å‘é‡åŒ–å›æ¸¬ä¸åŒï¼Œé€™æ˜¯é€ç­† (Tick-by-tick) æˆ–é€æ ¹ K ç·š (Bar-by-bar) çš„è™•ç†ã€‚
- å³æ™‚ç›£æ§å„€è¡¨æ¿ (Dashboard): SvelteKit é€é SSE (Servver-Sent Events) æˆ– WebSocket é¡¯ç¤ºå³æ™‚å ±åƒ¹èˆ‡æ¨¡æ“¬å–®ç‹€æ…‹ã€‚

#### Phase 4: å¯¦ç›¤è‡ªå‹•äº¤æ˜“ (Live Trading)

ç›®æ¨™ï¼šæ­£é•·ä¸²æ¥äº¤æ˜“æ‰€ API é€²è¡Œä¸‹å–®ã€‚

- API Key ç®¡ç†èˆ‡å®‰å…¨: ç¢ºä¿ API Key åŠ å¯†å„²å­˜ã€‚
- åŸ·è¡Œè·¯ç”±å™¨ (Execution Router): æ ¹æ“šä¿¡è™Ÿç™¼é€çœŸå¯¦è¨‚å–® (Market/Limit/Stop)ã€‚
- é¢¨éšªæ§åˆ¶æ¨¡çµ„ (Risk Management): é€™æ˜¯æœ€é‡è¦éƒ¨åˆ†ã€‚åœ¨ç™¼é€è¨‚å–®å‰å¼·åˆ¶æª¢æŸ¥ã€‚
  - å–®ç­†è™§æä¸è¶…éç¸½è³‡ç”¢ 2%
  - æ¯æ—¥æœ€å¤§è™§æåœæ­¢äº¤æ˜“
  - Kill Switch
- Line/Discord é€šçŸ¥: äº¤æ˜“ç™¼ç”Ÿæ™‚æ¨æ’­é€šçŸ¥åˆ°æ‰‹æ©Ÿã€‚

#### Phase 5: æ“´å±•èˆ‡ AI å­¸ç¿’ (Expansion & AI Training)

ç›®æ¨™ï¼šå¼•å…¥æ©Ÿå™¨å­¸ç¿’èˆ‡å‚³çµ±é‡‘èåˆ†æèˆ‡äº¤æ˜“ã€‚é€éå·²å»ºç«‹å¥½çš„å¯æ“´å±•æ¶æ§‹ï¼Œä½¿ç³»çµ±ä¹Ÿå¯ä»¥é€²è¡Œå‚³çµ±é‡‘è (è‚¡ç¥¨) åˆ†æèˆ‡äº¤æ˜“ã€‚

- å‚³çµ±é‡‘èé©é…: æ“´å…… Exchange ä»‹é¢ä»¥æ”¯æ´ IBKR (Interactive Brokers) æˆ– Alpacaã€‚éœ€è™•ç†ã€Œä¼‘å¸‚æ™‚é–“ã€èˆ‡ã€Œé™¤æ¬Šæ¯ã€ç­‰åŠ å¯†è²¨å¹£æ²’æœ‰çš„å•é¡Œã€‚
- æ©Ÿå™¨å­¸ç¿’: åˆ©ç”¨å·²æ”¶é›†çš„ Parquet æ•¸æ“šè¨“ç·´æ¨¡å‹ (LSTM, Transformer)ï¼Œä½œç‚ºç­–ç•¥çš„éæ¿¾å™¨ (Filter) æˆ–è¨Šè™Ÿç‚º (Signal)

## æ¶æ§‹èˆ‡å¯¦ä½œ

### Coding åŸå‰‡

- API çš„ response å›å‚³ï¼Œå„˜é‡ç”¨ Django-ninja çš„æ ¼å¼ã€‚
- è©³ç´° Response æ ¼å¼è¦ç¯„è«‹åƒé–± API.mdã€‚

### æ¶æ§‹åŸå‰‡

- æ•¸æ“šå„²å­˜ (Parquet vs Database)
  - ä½¿ç”¨ Postgres å„²å­˜ Metadata
  - ç›´æ¥ç”¨ Polars è®€å– Parquet æª”æ¡ˆï¼Œç¶“é‹ç®—å¾Œè½‰ JSON çµ¦å‰ç«¯ã€‚
  - Postgres åƒ…ç”¨ä¾†è¨˜éŒ„ã€Œå“ªäº›å¹£ç¨®æ­£åœ¨è¿½è¹¤ã€ã€ã€Œå›æ¸¬ç´€éŒ„æ‘˜è¦ã€ã€ã€Œä½¿ç”¨è€…è¨­å®šã€ç­‰ã€‚
- é–‹ç™¼ç’°å¢ƒ (Tasks & Setting)
  - tasks.json: è¦ä¸€å€‹ Parquet çš„åŒæ­¥ï¼Œæˆ–æ˜¯å‚³å…¥é›²ç«¯åšç‚ºè³‡æ–™åŒæ­¥
- å¾Œç«¯çµæ§‹ (Service Layer)
  - api.py åªè² è²¬è§£æ Requestã€é©—è­‰ Schemaï¼Œå‘¼å« services/ çš„å‡½å¼ï¼Œæœ€å¾Œå›å‚³ Respnoseã€‚
  - schemas.py è² è²¬å®šç¾© api.py æ‰€ä½¿ç”¨çš„ Schema
- å‰ç«¯ä»‹é¢ (TradingView)
  - Lightweight Charts åœ¨è™•ç†ã€Œå³æ™‚æ›´æ–°ã€æ™‚ï¼Œæ³¨æ„ Reactivityã€‚
  - å„˜é‡ä½¿ç”¨ Svelte 5 çš„æ–°ç‰¹æ€§è™•ç†ã€‚
- é ç•™å‚³çµ±é‡‘èçš„å»¶å±•æ€§ (TradFi)
  - éœ€è¦å…ˆåŠ å…¥ asset_type (Crypto/Stock/Forex) å’Œ market_hours åœ¨ Schemaã€‚
  - æä¾›å‚³çµ±é‡‘èéé€£çºŒæ€§çš„ç›¸é—œè¨­ç½®ã€‚
